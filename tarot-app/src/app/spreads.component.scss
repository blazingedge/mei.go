@use './mobile.scss' as *;

:host {
  /* paleta + layout */
  --bg:#0b1630; --bg-2:#0e1d3f;
  --gold:#d6b25e; --gold-2:#b9913a;
  --ink:#e6eaf5; --muted:#95a3c1;
  --error:#ff6b6b; --ok:#37c48f;
  --card-shadow:0 14px 28px rgba(0,0,0,.22), 0 6px 12px rgba(0,0,0,.18);

  --beige:#efe2c5; --beige-2:#e6d8b3; --beige-ink:#3b2f19;
  --mint:#54d88a; --mint-2:#2fbf71;

  /* <- estas dos son las que rompen la grilla cuando no existen */
  --rail: 72px;
  --panel: 360px;
}

.layout { display:grid; grid-template-columns: var(--rail) 1fr var(--panel); min-height: 100vh; }


/* ===========================================================
    RAIL IZQUIERDO 
   =========================================================== */

:host {
  --rail: 110px; /* â¬†ï¸ antes era 72px */
}

.rail {
  border-right: 1px solid rgba(214,178,94,.25);
  padding: 1rem .75rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  border-radius: 16px 0 0 16px;
  box-sizing: border-box;
  width: var(--rail);

  /* Fondo de papiro celta */
 background: url('https://pub-dd5dcc9095b64f479cded9e2d85818d9.r2.dev/assets/v1/cards/rail-burned.webp') center/cover no-repeat;

 box-shadow: inset 0 0   25px rgba(0, 0, 0, 0.35);


  /* === Controles principales === */
  .rail-controls {
    margin-top: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    gap: 0.6rem;

    /* ðŸ”¸ Fila de botones principales */
    .btn-row {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: .6rem;
      width: 100%;
    }
    


    button {
      flex: 1 1 calc(33% - 0.3rem);
      min-width: 90px;
      text-align: center;
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      font-weight: 600;
      color: #1a1405;
      padding: 0.45rem 0.5rem;
      border-radius: 10px;
      border: 1px solid rgba(0, 0, 0, 0.45);
      background: linear-gradient(180deg, #d6b25e, #b9913a);
      box-shadow:
        0 3px 0 #000,
        0 4px 10px rgba(0,0,0,.3),
        inset 0 1px 0 rgba(255,255,255,0.35);
      cursor: pointer;
      transition: all .25s ease;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    button:hover:not([disabled]) {
      transform: scale(1.05);
      box-shadow:
        0 3px 0 #000,
        0 6px 16px rgba(0,0,0,.4),
        inset 0 1px 0 rgba(255,255,255,0.4);
    }

    button[disabled] {
      opacity: .6;
      cursor: not-allowed;
      filter: grayscale(.4);
    }

    /* BotÃ³n activo (verde brillante) */
    button.active {
      background: linear-gradient(180deg, #54d88a, #2fbf71);
      border-color: #1d794f;
      color: #fff;
      box-shadow:
        0 3px 0 #000,
        0 5px 10px rgba(0,0,0,.3),
        inset 0 1px 0 rgba(255,255,255,0.25);
    }
  }

  

  /* === Zona de estado del mazo === */
  .rail-status-min {
    width: 70px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: .4rem;
    margin-top: .5rem;

    .status-text {
      font-size: .75rem;
      text-align: center;
      color: #3b2f19;
      font-weight: 600;
    }

    .fillbar {
      width: 42px;
      height: 120px;
      border: 1px solid rgba(0,0,0,.15);
      border-radius: 10px;
      background: rgba(255,255,255,0.6);
      overflow: hidden;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.25);
    }

    .fill {
      width: 100%;
      height: 0%;
      background: linear-gradient(180deg, var(--mint), var(--mint-2));
      transition: height .45s ease;
    }
  }

  /* === Botones fantasma (barajar / historial) === */
  .rail-ghosts .ghost-btn{
  width: 42px; height: 42px; border-radius: 10px; border: 1px solid rgba(0,0,0,.35);
  background-color: rgba(255,255,255,0.25); background-size: cover; background-position:center;
  }
  .ghost--shuffle{
  background-image: url('/assets/ui/icons/shuffle.webp'); /* genera con Sora y sÃºbelo */
  }
  .ghost--history{
  background-image: url('https://pub-dd5dcc9095b64f479cded9e2d85818d9.r2.dev/assets/v1/cards/historial.webp');
  }
.ghost--saved{
  background-image: url('/assets/ui/icons/saved.webp'); /* genera con Sora y sÃºbelo */
  }
}
.rail-controls .seg {
     display: flex;
     flex-direction: column;
      align-items: center;
      gap: 0.6rem;
    }

.drucoins-hud{
  position: absolute;
  top: 10px; right: 10px;
  display:flex; align-items:center; gap:.4rem;
  padding:.35rem .5rem; border-radius:12px;
  background: rgba(0,0,0,.45); backdrop-filter: blur(4px);
  border:1px solid rgba(214,178,94,.35);
  z-index: 12; cursor:pointer;
  .coin{ width:28px; height:28px; object-fit:contain; filter: drop-shadow(0 2px 6px rgba(0,0,0,.5)); }
  .counter{ line-height:1; color:#f8f3dc;
    strong{ font-size:1.05rem; color:#d6b25e }
    small{ font-size:.75rem; opacity:.9; margin-left:.1rem; }
  }
}




@keyframes spin {
  to { transform: rotate(360deg); }
}

/* ===========================================================
   ðŸ”® BOARD PRINCIPAL
   =========================================================== */

:host {
  position: relative;
  isolation: isolate; /* crea contexto propio y separa el tablero del modal */
  z-index: 0;
}



.board {
  min-height: calc(100vh - 40px);
  padding-top: 3vh;
  position: relative;
  background-size: cover;
  background-position: center;
  overflow: hidden;

  background-image: url('https://lumiere-api.laife91.workers.dev/cdn/cards/celtic-cloth.webp');
}



.board::after {
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:0;
  background:radial-gradient(ellipse at center, rgba(0,0,0,.35), rgba(0,0,0,.55) 70%);
}

.layer-pills {
  position: absolute;
  top: 0.75rem;
  right: 1rem;
  display: flex;
  gap: 0.35rem;
  z-index: 6;

  button {
    padding: 0.3rem 0.8rem;
    border-radius: 999px;
    border: 1px solid rgba(214,178,94,.4);
    background: rgba(10,12,18,.65);
    color: var(--ink);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: all .2s ease;

    &.active {
      background: linear-gradient(180deg, #d6b25e, #b9913a);
      color: #1a1405;
      box-shadow: 0 3px 10px rgba(0,0,0,0.25);
    }
  }
}

.board-actions {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 1rem;
  z-index: 8;
  flex-wrap: wrap;
  justify-content: center;
}

.btn-main {
  padding: 0.65rem 1.8rem;
  border-radius: 999px;
  border: none;
  font-family: 'Cinzel', serif;
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  background: linear-gradient(180deg, #d6b25e, #b9913a);
  color: #1a1405;
  cursor: pointer;
  box-shadow: 0 6px 14px rgba(0,0,0,0.35);
  transition: transform .2s ease, box-shadow .2s ease, opacity .2s ease;

  &:hover:not([disabled]) {
    transform: translateY(-2px);
    box-shadow: 0 10px 18px rgba(0,0,0,0.4);
  }

  &.secondary {
    background: rgba(10,12,18,.65);
    color: var(--ink);
    border: 1px solid rgba(214,178,94,.35);
  }

  &[disabled] {
    opacity: .55;
    cursor: not-allowed;
  }
}

.board-empty {
  position: absolute;
  top: 45%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--ink);
  font-family: 'Cardo', serif;
  font-size: 1.05rem;
  letter-spacing: 0.03em;
  text-align: center;
  padding: 0.75rem 1.5rem;
  background: rgba(0,0,0,0.45);
  border: 1px solid rgba(214,178,94,0.3);
  border-radius: 12px;
  z-index: 5;
}

/* Selector de tirada */
.spread-select {
  position:absolute;
  top:.5rem; left:.5rem;
  z-index:6;
  display:flex;
  flex-direction:column;
  gap:.15rem;

  .label { font-size:.75rem; opacity:.85; }

  .select-wrap { position:relative; }

  select {
    appearance:none;
    -webkit-appearance:none;
    background: linear-gradient(180deg, rgba(214,178,94,0.95), rgba(139,110,60,0.85));
    color: #1a1405;
    border: 1px solid rgba(255,255,255,0.25);
    border-radius: 12px;
    padding: .45rem 1.6rem .45rem .6rem;
    min-width: 230px;
    font-weight: 600;
    font-family: 'Cinzel', serif;
    box-shadow: 0 3px 0 #000, 0 6px 10px rgba(0,0,0,0.35);
    transition: all .25s ease;
  }

  select:hover {
    background: linear-gradient(180deg, #e3c978, #b88a38);
    transform: scale(1.03);
  }

  .caret {
    position:absolute;
    right:.5rem;
    top:50%;
    transform:translateY(-50%);
    pointer-events:none;
    color:#000;
  }
}

/* ===========================================================
   ðŸƒ MAZO 
   =========================================================== */
.deck-pile {
  position: absolute;
  left: clamp(8px,2vw,16px);
  bottom: clamp(36px,4vw,48px); /* â¬†ï¸ subido */
  width: min(10vw,140px);
  aspect-ratio: 2.5/4;
  z-index: 10;
  cursor: pointer;
  pointer-events: auto;
}

.deck-pile img {
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  border-radius:12px;
  box-shadow:0 8px 18px rgba(0,0,0,.35);
}

.deck-pile img:nth-child(1){ transform:translate(0,0) rotate(-3deg); }
.deck-pile img:nth-child(2){ transform:translate(6%,-2%) rotate(2deg); }
.deck-pile img:nth-child(3){ transform:translate(12%,-4%) rotate(-1deg); }
.deck-pile img:nth-child(4){ transform:translate(18%,-6%) rotate(1.5deg); }
.deck-pile img:nth-child(5){ transform:translate(24%,-8%) rotate(-.5deg); }

.deck-pile.shuffle img:last-child {
  animation: shuffle 900ms ease infinite;
  transform-origin:70% 50%;
}

@keyframes shuffle {
  0%{transform:translate(24%,-8%) rotate(-.5deg)}
  50%{transform:translate(40%,-20%) rotate(12deg)}
  100%{transform:translate(24%,-8%) rotate(-.5deg)}
}

.deck-pile .deck-label {
  position:absolute;
  left:6px;
  bottom:-12px;
  background:#fff;
  color:var(--beige-ink);
  border:1px solid rgba(0,0,0,.15);
  border-radius:999px;
  padding:.15rem .5rem;
  font-weight:700;
  font-size:.9rem;
}

/* ===========================================================
   ðŸ“œ CAMPO DE CONTEXTO (papiro cuadrado)
   =========================================================== */

.context-area textarea {
  background: url('/assets/ui/papiro-note.jpg') no-repeat center/cover;
  border: 2px solid rgba(139, 110, 60, 0.5);
  border-radius: 12px;
  padding: 3rem;
  font-family: 'Cardo', serif;
  font-size: 1rem;
  color: #3b2f19;
  resize: none;
  box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.25);
}

.context-wrap {
  display: flex;
  align-items: center;
  flex-direction: column;     /* centra verticalmente */
  justify-content: space-between;
  gap: 1rem;
  margin-top: 1rem;

  /* lÃ­mites suaves dentro del panel */
  padding: 0.5rem 0.2rem;
}

/* el Ã¡rea del texto ocupa casi todo el ancho */
.context-wrap .context-area {
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* botÃ³n al lado derecho */
.context-wrap .context-action {
  display: flex;
  align-items: vertical;
  justify-content: center;
}

/* reduce el tamaÃ±o del botÃ³n para que encaje visualmente */
.context-wrap .btn-papiro {
  white-space: nowrap;
  padding: 0.6rem 1rem;
  font-size: 0.95rem;
}

@media (max-width: 800px) {
  .context-wrap {
    flex-direction: column;
    align-items: stretch;
  }

  .context-wrap .context-action {
    justify-content: flex-end;
  }
}

/* ===========================================================
   ðŸ”® DEMÃS SECCIONES (interpret-modal, cards, etc.)
   =========================================================== */


/* Slots y cartas */
.slot,
.card {
  --x: 50%;
  --y: 25%; /* â¬†ï¸ antes 28% â€” sube ligeramente todo el conjunto */
  --r: 0deg;

  position: absolute;
  left: var(--x);
  top: var(--y);

  /* ðŸ”¹ centrado ajustado: sube 10% adicional para equilibrar visualmente */
  transform: translate(-50%, calc(-50% - 10%));
}

/* Mantiene los estilos base */
.slot {
  width: min(16vw, 220px);
  aspect-ratio: 2.5/4;
  border: 2px dashed rgba(214,178,94,.35);
  border-radius: 16px;
  filter: drop-shadow(0 8px 18px rgba(0,0,0,.25));
  transition: border-color .2s ease;
  z-index: 1;
  &:hover { border-color: var(--gold); }

  &::after {
    content: attr(data-pos);
    position: absolute;
    top: -10px;
    left: -10px;
    background: rgba(11,22,48,.85);
    color: var(--gold);
    border: 1px solid rgba(214,178,94,.5);
    border-radius: 10px;
    padding: .1rem .35rem;
    font-size: .8rem;
  }
}


/* ====== CARD (giro dentro de .card-inner) ====== */
.card {
  width: min(16vw, 220px);
  aspect-ratio: 2.5 / 4;
  z-index: 3;
  opacity: 0;
  animation: dealIn 0.4s ease forwards;
  animation-delay: var(--delay-ms, 0ms);
  transition: transform 0.4s ease, filter 0.2s ease;

  &.dealt { filter: drop-shadow(var(--card-shadow)); }

  .card-inner {
    width: 100%;
    height: 100%;
    transform-origin: center center;
    transform: rotateZ(var(--r));           /* â† giro de cruce */
    transition: transform 0.6s ease;
    transform-style: preserve-3d;
    perspective: 1000px;

    img {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      border-radius: 14px;
      backface-visibility: hidden;
    }

    .front { transform: rotateY(180deg); }
    .back  { transform: rotateY(0deg); filter: brightness(0.92) contrast(1.05); }
  }

  /* Volteo de caras (la clase estÃ¡ en .card) */
  &.faceup .card-inner .front { transform: rotateY(0deg); }
  &.faceup .card-inner .back  { transform: rotateY(180deg); }

  /* Carta invertida sobre el eje correcto */
  &.reversed .card-inner { transform: rotateZ(calc(var(--r) + 180deg)); }

  /* Hover sutil */
  &:hover .card-inner { transform: rotateZ(calc(var(--r) + 4deg)) scale(1.03); }
}

/* Fuerza a que las cartas con --r=90 se dibujen horizontales */
.card[style*="--r:90"] .card-inner,
.card[data-pos="2"] .card-inner {
  transform: rotateZ(90deg) !important;
  transform-origin: center center;
}

/* Si estÃ¡ invertida (reversed), la dejamos horizontal pero girada */
.card.reversed[style*="--r:90"] .card-inner,
.card.reversed[data-pos="2"] .card-inner {
  transform: rotateZ(270deg) !important;
}


/* ðŸŽžï¸ AnimaciÃ³n de entrada */
@keyframes dealIn {
  from { opacity: 0; transform: translate(-50%, -30%) scale(0.9); }
  to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

/* âœ¨ AnimaciÃ³n especial para carta #2 (si el HTML tiene data-pos="2") */
.card[data-pos="2"] .card-inner { animation: crossDrop 0.7s ease forwards; }
@keyframes crossDrop {
  0%   { transform: rotateZ(0deg) translateY(-40px) scale(0.9); opacity: 0; }
  70%  { opacity: 1; }
  100% { transform: rotateZ(var(--r)) translateY(0) scale(1); opacity: 1; }
}

/* (Opcional) Compatibilidad con overrides antiguos de 90Â° usando ng-deep */
:host ::ng-deep .card[style*="--r:90deg"] .card-inner {
  transform: rotateZ(90deg) !important;
}
:host ::ng-deep .card.reversed[style*="--r:90deg"] .card-inner {
  transform: rotateZ(270deg) !important;
}


/* CDK Drag */
.cdk-drag-preview{ box-shadow:0 12px 18px rgba(0,0,0,.35); border-radius:14px; }
.cdk-drag-placeholder{ opacity:.2; }
.cdk-drag-animating{ transition:transform .2s ease; }

/* Panel derecho */
.panel{
  border-left:1px solid rgba(214,178,94,.25);
  display:grid; grid-template-rows:auto 1fr auto;
  background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.00));
  h3{ margin:1rem; color:var(--gold); }
  .panel-body{ padding:0 1rem 1rem; overflow:auto; }
  .panel-footer{ border-top:1px solid rgba(214,178,94,.25); padding:.75rem 1rem; display:flex; gap:.5rem; justify-content:flex-end;
    button{ background:rgba(255,255,255,.06); color:var(--ink); border:1px solid rgba(214,178,94,.35); border-radius:10px; padding:.45rem .75rem; }
    .warn{ color:#fff; background:#b44; border-color:#b44; }
  }
  .muted{ color:var(--muted); } .rev{ color:var(--gold); }
}




/* === Modal de Historial / Overlay === */
.history-modal {
  position: fixed !important;
  inset: 0;
  z-index: 10000; /* ðŸ”º MÃ¡ximo absoluto */
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(6px);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.25s ease-in-out;
}

.history-modal.visible {
  opacity: 1;
  pointer-events: all;
}

/* Forzar que el contenedor estÃ© en su propio contexto 3D */
:host {
  position: relative;
  isolation: isolate; /* ðŸ”¥ evita que transform/3D del tablero cree stacking superior */
}

.history-card {
  width: min(720px, 92vw);
  max-height: 80vh;
  overflow-y: auto;
  background: #101828;
  color: #eef2ff;
  border: 1px solid rgba(214, 178, 94, 0.35);
  border-radius: 14px;
  box-shadow: 0 24px 48px rgba(0, 0, 0, 0.55), 0 0 0 2px rgba(214, 178, 94, 0.2);
  padding: 0.5rem 0.75rem 1rem;
  transform: translateY(15px);
  animation: modalAppear 0.3s ease forwards;
  z-index: 1000000; /* encima de todo */
}

@keyframes modalAppear {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* lista, botones y responsive conservan tu estilo actual */
.history-list {
  list-style: none;
  padding: 0;
  margin: 0.75rem 0;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
}
.history-list li {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem;
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 10px;
}



.history-card header{ display:flex; align-items:center; justify-content:space-between; padding:.25rem .25rem .5rem; border-bottom:1px solid rgba(214,178,94,.25); }
.history-card header .close{ background:transparent; color:#fff; border:0; font-size:1.4rem; line-height:1; }
.history-list .meta{ display:flex; align-items:center; gap:.35rem; }
.history-list .actions{ display:flex; gap:.35rem; }
.history-card footer{ display:flex; justify-content:flex-end; gap:.5rem; }

.history-modal.visible::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, rgba(214,178,94,0.25) 0%, transparent 70%);
  pointer-events: none;
  z-index: 0;
  opacity: 0.8;
}


/* Responsive */
@media (max-width:1100px){ .layout{ grid-template-columns: var(--rail) 1fr 300px; } }
@media (max-width:860px){
  .layout{ grid-template-columns: 1fr; }
  .rail{ flex-direction:row; justify-content:space-between; border-right:none; border-bottom:1px solid rgba(214,178,94,.25); }
  .panel{ order:3; } .board{ order:2; min-height:60vh; }
}

@media (max-width: 768px) {
  .board { transform: scale(0.9); }
  .controls { flex-direction: column; }
}

/* ===========================================================
   ðŸ”® Modal de interpretaciÃ³n (papiro + rail lateral)
   =========================================================== */
.interpret-modal {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
  background: rgba(0, 0, 0, 0.65);
  backdrop-filter: blur(3px);
  animation: fadeIn 0.5s ease;
  @keyframes fadeIn { from { opacity: 0; transform: scale(0.96); } to { opacity: 1; transform: scale(1); } }
}

.interpret-container {
  position: relative;
  width: min(950px, 96vw);
  height: auto;
  max-height: calc(100svh - 32px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  display: flex;
  flex-direction: column;
  border: 2px solid rgba(168,134,62,0.6);
  border-radius: 18px;
  overflow: hidden;
  background: #f9f3e4;
  background-image: url('/assets/textures/paper.jpg'),
                    radial-gradient(circle at top left, #fdf7e8, #f2e5c0);
  background-blend-mode: multiply;
  box-shadow: 0 18px 40px rgba(0,0,0,.45);
  animation: popup 240ms ease-out;
}
@keyframes popup { from { transform: translateY(8px) scale(.98); opacity:.0 } to { transform:none; opacity:1 } }


.interpret-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.55); }

.interpret-header {
  display: flex; align-items: center; gap: .75rem;
  padding: .85rem 1rem;
  background: rgba(249,238,211,.92);
  border-bottom: 1px solid rgba(168,134,62,.35);
  h2 { margin: 0; font: 600 1.1rem 'Cinzel', serif; color:#5a4418; letter-spacing:.3px; }
  .spacer { flex: 1 }
  .close-btn { background: transparent; border: 0; font-size: 1.6rem; color:#5a4418; cursor: pointer; }
}


.interpret-body {
  display: flex;
  min-height: 0;            /* clave para flex + overflow */
  flex: 1 1 auto;
  overflow-y: auto;
  padding: 1.5rem;
  gap: 1rem
}

.interpret-text {
  flex: 3;
  padding: 1rem 1.1rem;
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.05rem;
  line-height: 1.6;
  overflow-y: auto;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  scrollbar-gutter: stable;
}
.interpret-text::-webkit-scrollbar { width: 8px }
.interpret-text::-webkit-scrollbar-thumb { background: rgba(168,134,62,0.65); border-radius: 4px }


/* Rail lateral con scroll propio */
.interpret-rail {
  flex: 1;
  min-width: 220px;
  max-width: 320px;
  border-left: 2px solid rgba(168,134,62,0.3);
  background: #f6eed8;
  padding: .9rem .8rem;
  overflow-y: auto;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  h4 { margin:.2rem 0 .6rem; font: 600 1rem 'Cinzel', serif; color:#7a6331; text-align:center; }
  ul { list-style:'âœ¶ '; padding-left: 1rem; margin: 0;
    li { margin-bottom: .55rem; }
  }
}

/* efecto dorado tenue */
.interpret-container::after {
  content: "";
  position: absolute; inset: 0; pointer-events: none;
  background: linear-gradient(135deg, rgba(255,255,200,.05), transparent 70%);
  mix-blend-mode: overlay; animation: shimmer 6s infinite alternate;
}
@keyframes shimmer { 0% { opacity:.1 } 100% { opacity:.3 } }

:host-context(body.modal-open) .layout { overflow: hidden }

.loading-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at center, rgba(11,22,48,0.95) 0%, rgba(0,0,0,0.85) 100%);
  backdrop-filter: blur(4px);
  z-index: 2000;
  color: var(--gold, #d6b25e);
  text-align: center;
  font-family: 'Cinzel Decorative', serif;
  animation: fadeIn 0.4s ease;
}

.loading-art {
  width: 120px;
  height: 120px;
  object-fit: contain;
  filter: drop-shadow(0 0 12px rgba(214,178,94,0.7));
  animation: floatY 2.5s ease-in-out infinite;
  margin-bottom: 1rem;
}

.loading-overlay p {
  font-size: 1.2rem;
  text-shadow: 0 0 8px rgba(214,178,94,0.6);
}

@keyframes floatY {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/* ===========================================================
   ðŸ”® Modal de contexto / pregunta personal
   =========================================================== */
   
.context-modal {
  position: fixed;
  inset: 0;
  z-index: 1200;
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(6px);
  background: rgba(0, 0, 0, 0.65);
  animation: fadeIn 0.3s ease;

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.96); }
    to   { opacity: 1; transform: scale(1); }
  }
}

.context-box {
  position: relative;
  background: linear-gradient(160deg, #0e1d3f, #162a5e 85%);
  border: 1px solid rgba(214, 178, 94, 0.5);
  border-radius: 1rem;
  box-shadow: 0 0 40px rgba(0, 0, 0, 0.45);
  color: #e6eaf5;
  font-family: 'Merriweather', serif;
  width: 90%;
  max-width: 640px;
  padding: 1.8rem 1.6rem;
  animation: slideUp 0.35s ease-out;

  @keyframes slideUp {
    from { transform: translateY(30px); opacity: 0; }
    to   { transform: translateY(0); opacity: 1; }
  }

  h2 {
    text-align: center;
    color: #d6b25e;
    font-family: 'Cinzel Decorative', serif;
    letter-spacing: 0.4px;
    font-size: 1.3rem;
    margin-bottom: 1.2rem;
    text-shadow: 0 0 8px rgba(214,178,94,0.35);
  }

  textarea {
    width: 100%;
    min-height: 120px;
    border: 1px solid rgba(214,178,94,0.45);
    border-radius: 10px;
    background: rgba(255,255,255,0.06);
    color: #e6eaf5;
    padding: 0.9rem 1rem;
    resize: none;
    font-size: 1rem;
    line-height: 1.4;
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.35);
    transition: border-color .2s ease, box-shadow .2s ease;

    &::placeholder {
      color: rgba(239,231,210,0.6);
      font-style: italic;
    }

    &:focus {
      outline: none;
      border-color: #caa448;
      box-shadow: 0 0 0 3px rgba(202,164,72,0.18),
                  inset 0 2px 6px rgba(0,0,0,0.45);
    }
  }

  .actions {
    margin-top: 1.4rem;
    display: flex;
    justify-content: center;
    gap: 1rem;
  }

  .btn {
    background: linear-gradient(180deg, #d6b25e, #b9913a);
    border: 1px solid #8a6c22;
    color: #1a1405;
    padding: 0.65rem 1.4rem;
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
    letter-spacing: 0.3px;
    box-shadow: 0 4px 14px rgba(202,164,72,0.25),
                inset 0 1px 0 rgba(255,255,255,0.25);
    transition: transform 0.1s ease, box-shadow 0.25s ease;

    &:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(202,164,72,0.35),
                  inset 0 1px 0 rgba(255,255,255,0.3);
    }

    &.cancel {
      background: rgba(255,255,255,0.1);
      color: #ddd;
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 0 10px rgba(0,0,0,0.35);
      &:hover {
        background: rgba(255,255,255,0.2);
        color: #fff;
      }
    }
  }

  /* âœ¨ DecoraciÃ³n dorada */
  &::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    background: linear-gradient(
      135deg,
      rgba(214,178,94,0.08),
      rgba(214,178,94,0.02) 60%,
      transparent 80%
    );
    mix-blend-mode: overlay;
    animation: shimmer 6s ease-in-out infinite alternate;
  }
}

@keyframes shimmer {
  0% { opacity: 0.15; }
  100% { opacity: 0.4; }
}

/* ðŸ“± Responsive */
@media (max-width: 600px) {
  .context-box {
    width: 94%;
    padding: 1.2rem;
    textarea {
      font-size: 0.95rem;
      min-height: 100px;
    }
    h2 {
      font-size: 1.1rem;
    }
  }
}

/* Panel derecho redondeado */
.panel {
  border-radius: 0 16px 16px 0;
  overflow: hidden;
  background: linear-gradient(180deg, #faf6ec, #f3e8c6);
  box-shadow: inset 0 0 10px rgba(168, 134, 62, 0.25);
}

/* Rail izquierdo redondeado */


/* CÃ¡psulas de carta */
.cards-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.card-chip {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.7rem;
  border-radius: 999px;
  background: linear-gradient(90deg, #f5f0d9, #f9f3e4);
  border: 1px solid rgba(168,134,62,0.45);
  color: #3b2f19;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);

  &:hover {
    background: linear-gradient(90deg, #f3e2b5, #f0d78a);
    transform: scale(1.03);
  }

  &.reversed {
    background: linear-gradient(90deg, #e4c7c7, #f1d0d0);
  }

  .num {
    background: #b9913a;
    color: #fff;
    border-radius: 50%;
    width: 1.4rem;
    height: 1.4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
  }

  .rev {
    color: #b44;
    margin-left: auto;
    font-weight: bold;
  }
}

/* Overlay del significado de carta */
.card-meaning-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 10, 30, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;

  .meaning-box {
    background: #fdf7e4;
    border-radius: 12px;
    padding: 1.5rem 2rem;
    max-width: 640px;
    width: 90%;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
    color: #3a2b18;
    font-family: "Cardo", serif;
    animation: fadeIn 0.25s ease;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;

    h3 {
      font-weight: 700;
      font-size: 1.25rem;
      color: #5a4325;
    }

    .close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #8b6e40;

      &:hover {
        color: #5a4325;
      }
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(6px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}




/* BotÃ³n papiro */
.btn-papiro {
  display: inline-block;
  margin-top: 0.8rem;
  background: url('/assets/textures/paper.jpg'),
              linear-gradient(180deg, #f7eac6, #ebd79a);
  background-blend-mode: multiply;
  border: 2px solid #b9913a;
  border-radius: 12px;
  color: #2e230e;
  font-weight: 700;
  font-family: 'Cinzel', serif;
  padding: 0.6rem 1.2rem;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  transition: all 0.2s ease;

  &:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  }
}


