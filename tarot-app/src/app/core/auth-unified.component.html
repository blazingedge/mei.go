<!-- ===========================================================
     âœ¨ INTRO EFECTO "EL MEIGO"
=========================================================== -->
<div class="intro-overlay" *ngIf="showIntro">
  <app-intro-particles></app-intro-particles>
  <h1 class="intro-text">El meigo</h1>
</div>

<!-- ===========================================================
     ðŸ§¿ LAYOUT PRINCIPAL AUTH
=========================================================== -->
<div class="auth-layout">
  
  <!-- LOGO / LADO IZQUIERDO -->
  <div class="auth-left">
    <app-logo></app-logo>
  </div>

  <!-- FORMULARIOS -->
  <div class="auth-right">
    <div class="auth-card">

      <!-- =============================
           ðŸ”‘ LOGIN
      ============================== -->
      <section class="section">
        <h2>Iniciar sesiÃ³n</h2>

        <form (ngSubmit)="onLogin()" #loginForm="ngForm">
          <input type="email"
                 name="loginEmail"
                 placeholder="Email"
                 required
                 [(ngModel)]="login.email"
                 [disabled]="loading"/>

          <input type="password"
                 name="loginPassword"
                 placeholder="ContraseÃ±a"
                 required
                 [(ngModel)]="login.password"
                 [disabled]="loading"/>

          @if (loginError) {
            <p class="error">{{ loginError }}</p>
          }

          <button type="submit"
                  class="btn-main"
                  [disabled]="loginForm.invalid || loading">
            Entrar
          </button>

          <div class="forgot">
          <a (click)="onForgotPassword()">Â¿Olvidaste tu contraseÃ±a?</a>
          </div>

        </form>
      </section>

      <div class="divider"><span>Ã³</span></div>

      <!-- =============================
           ðŸŒ LOGIN SOCIAL
      ============================== -->
      <div class="social">
        <button class="social-btn google"
                type="button"
                (click)="authGoogle()"
                [disabled]="loading">
          <img src="assets/google.svg" alt="Google login" />
        </button>

        <button class="social-btn facebook"
                type="button"
                (click)="authFacebook()"
                [disabled]="loading">
          <img src="assets/facebook.svg" alt="Facebook login" />
        </button>
      </div>
      <p class="popup-hint">
        En Chrome y Firefox debes permitir las ventanas emergentes para este sitio para usar Google.
      </p>

      <div class="divider thin"></div>

      <!-- =============================
           ðŸª„ REGISTRO
      ============================== -->
      <section class="section">
        <h2>RegÃ­strate</h2>

        <form (ngSubmit)="onRegister()" #regForm="ngForm">

          <input type="email"
                 name="regEmail"
                 placeholder="Email"
                 required
                 [(ngModel)]="register.email"
                 [disabled]="loading"/>

          <input type="password"
                 name="regPassword"
                 placeholder="ContraseÃ±a"
                 required
                 [(ngModel)]="register.password"
                 [disabled]="loading"/>

          <input type="password"
                 name="regConfirm"
                 placeholder="Repetir contraseÃ±a"
                 required
                 [(ngModel)]="register.confirm"
                 [disabled]="loading"/>

          @if (regError) {
            <p class="error">{{ regError }}</p>
          }

          <!-- CAPTCHA CORREGIDO -->
          <div id="cf-turnstile"></div>

          <!-- BotÃ³n principal -->
          <button type="submit"
                  class="btn-main"
                  [disabled]="regForm.invalid || loading">
            Crear cuenta
          </button>

          <!-- BotÃ³n de tÃ©rminos -->
          <button type="button"
                  class="terms-btn"
                  (click)="openTerms()">
            Ver TÃ©rminos y Condiciones
          </button>
        </form>
      </section>

    </div>
  </div>
</div>

<!-- ===========================================================
     ðŸ“ MODAL DE TÃ‰RMINOS Y CONDICIONES (SE AGREGA AQUÃ)
=========================================================== -->
<app-terms-modal></app-terms-modal>


<!-- ===========================================================
      ðŸ” MODAL DE RESTABLECER LA CONTRASAEÃ‘A
=========================================================== -->
@if (showForgotModal) {
  <app-forgot-password-modal
    (closed)="closeForgotPassword()">
  </app-forgot-password-modal>
}
