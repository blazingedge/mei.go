<!-- INTRO EFECTO "EL MEIGO" -->
<div class="intro-overlay" *ngIf="showIntro">
  <app-intro-particles></app-intro-particles>
  <h1 class="intro-text">El meigo</h1>
</div>

<!-- LAYOUT PRINCIPAL -->
<div class="auth-layout">
  <div class="auth-left">
    <app-logo></app-logo>
  </div>

  <div class="auth-right">
    <div class="auth-card">
      <!-- LOGIN -->
      <section class="section">
        <h2>Iniciar sesi√≥n</h2>
        <form (ngSubmit)="onLogin()" #loginForm="ngForm">
          <input type="email" name="loginEmail" [(ngModel)]="login.email" required placeholder="email" [disabled]="loading"/>
          <input type="password" name="loginPassword" [(ngModel)]="login.password" required placeholder="contrase√±a" [disabled]="loading"/>
          @if (loginError) { <p class="error">{{ loginError }}</p> }
          <button type="submit" [disabled]="loginForm.invalid || loading">Entrar</button>
        </form>
      </section>

      <div class="divider"><span>√≥</span></div>

      <div class="social">
        <button class="social-btn google" type="button" (click)="authGoogle()" [disabled]="loading">
          <img src="assets/google.svg" alt="Google login" />
        </button>
        <button class="social-btn facebook" type="button" (click)="authFacebook()" [disabled]="loading">
          <img src="assets/facebook.svg" alt="Facebook login" />
        </button>
      </div>

      <div class="divider thin"></div>

      <!-- REGISTER -->
      <section class="section">
        <h2>Reg√≠strate</h2>
        <form (ngSubmit)="onRegister()" #regForm="ngForm">
          <input type="email" name="regEmail" [(ngModel)]="register.email" required placeholder="email" [disabled]="loading"/>
          <input type="password" name="regPassword" [(ngModel)]="register.password" required placeholder="contrase√±a" [disabled]="loading"/>
          <input type="password" name="regConfirm" [(ngModel)]="register.confirm" required placeholder="repetir contrase√±a" [disabled]="loading"/>
          @if (regError) { <p class="error">{{ regError }}</p> }
          <button type="submit" [disabled]="regForm.invalid || loading">Crear cuenta</button>

          <!-- bot√≥n de t√©rminos -->
          <button type="button" class="terms-btn" (click)="openTerms()">Ver T√©rminos</button>
        </form>
      </section>

      <div class="cf-turnstile" data-sitekey="0x4AAAAAACAX4mmeQUvYpIQr" data-theme="auto" data-callback="onCaptchaVerified"></div>
    </div>
  </div>
</div>

<!-- üîÆ Modal DEBE IR AQU√ç, FUERA del auth-layout -->
<app-terms-modal
  [visible]="showTerms"
  (accepted)="onTermsAccepted()"
  (closed)="onTermsClosed()">
</app-terms-modal>
